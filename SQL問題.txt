*SQL–â‘è‚Ì–â1*

select tblCustName.custId, tblCustName.name,

mstAddress.addId, mstAddress.ctry,

case when mstAddress.ctry = "JP" then JP else FOL end as address,

count(tblCustCardRelation.custId) as card

from tblCustName inner join tblCustAdd on

tblCustName.custId = tblCustAdd.custId

left join mstAddress on

mstAddress.addId = tblCustAdd.addId

left join tblCustCardRelation on

tblCustCardRelation.custId = tblCustAdd.custId

group by tblCustName.custId;



*–â2*

select tblCustName.name, tblCard.point

from tblCustName left join tblCustCardRelation on

tblCustName.custId = tblCustCardRelation.custId

left join tblCard on

tblCard.cardId = tblCustCardRelation.cardId;



*–â3*

select tblCustName.name

from tblCustName inner join tblCustCardRelation on

tblCustName.custId = tblCustCardRelation.custId

group by name having count(tblCustCardRelation.custId) > 1;



*–â4*

select tblCustName.name, ifnull(sum(tblCard.point),"0") as point

from tblCustName left join tblCustCardRelation on

tblCustName.custId = tblCustCardRelation.custId

left join tblCard on

tblCard.cardId = tblCustCardRelation.cardId

group by tblCustName.name;